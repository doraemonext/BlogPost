# 指针与 const 限定符详解

这里分析一下 C 语言中当 const 关键字遇到各种指针时的对应意义，以及我自己记忆它们的方法，希望能对你有所帮助。

因为当多级指针和 `const` 混合在一起会显得异常复杂，比如 `const int *const **const *p;` 之类的（虽然现实中应该没人用这么多级的指针）。但不管多复杂的组合，判断方法都很简单：

* 如果起始是 `const int` 这种顺序，在大脑里面将它倒过来，变成 `int const`，方便后面分析；
* 从右向左依次扫描每一个 `const`，对每一个 `const` 提取该 `const` 之后的所有字符，然后将提取后的字符串中所有的 `const` 清除；
    * 举个例子，比如 `int const *const **p;`，碰到右边第一个 `const` 之后，提取右面的所有字符，即 `**p`，清除后仍为 `**p`；
    * 然后碰到第二个 `const`，提取右面的所有字符，即 `*const **p`，清除所有 `const` 后，为 `***p`；
* 提取得到的指针描述（如 `**p`）即为不可改写；
* 重复上述步骤，直到扫描完所有的 `const`；
* 剩下的所有层级的指针描述均可改写；

下面我们再来举几个例子。

## 一级指针

这是最简单的情况：

    const int *a;
    int const *a;
        
`const` 后面提取出的指针描述为 `*a`，所以 `*a` 不可改写。剩下的指针描述 `a` 则允许被改写。

-----------------

    int *const a;
    
`const` 后面提取出的指针描述为 `a`，所以 `a` 不可改写。剩下的指针描述 `*a` 则允许被改写。

-----------------

    int const *const a;
    
右边第一个 `const` 后面提取出的指针描述为 `a`，所以 `a` 不可改写。

右边第二个 `const` 后面提取出的指针描述为 `*a`，所以 `*a` 仍然不可被改写。

## 二级指针

二级指针略显复杂，让我们继续来分析。

    const int **a;
    
`const` 后面提取出的指针描述为 `**a`，所以 `**a` 不可改写。剩下的指针描述 `*a`，`a` 均可被改写。

--------------------

    int *const *a;
    
`const` 后面提取出的指针描述为 `*a`，所以 `*a` 不可改写。剩下的指针描述 `**a`，`a` 均可被改写。

---------------------

    int **const a;
    
`const` 后面提取出的指针描述为 `a`，所以 `a` 不可改写。剩下的指针描述 `**a`，`*a` 均可被改写。

----------------------

    int *const *const a;
    
右边第一个 `const` 后面提取出的指针描述为 `a`，所以 `a` 不可改写。

右边第二个 `const` 后面提取出的指针描述为 `*a`，所以 `*a` 不可改写。

剩下的指针描述 `**a` 可以被改写。

-------------------------

大概就是这样，如果上述结论有错误欢迎留言。


